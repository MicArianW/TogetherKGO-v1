<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Submit Community Update - TogetherKGO</title>
  <link rel="stylesheet" href="assets/styles.css" />
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <style>
    .submission-form {
      max-width: 700px;
      margin: 40px auto;
      padding: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 1px solid #dcdcdc;
      border-radius: 8px;
      font-size: 16px;
    }

    .form-group textarea {
      min-height: 150px;
      resize: vertical;
    }

    .form-hint {
      font-size: 14px;
      color: #666;
      margin-top: 4px;
    }

    .submit-btn {
      background: #22c55e;
      color: white;
      padding: 14px 32px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      transition: background 0.2s;
    }

    .submit-btn:hover {
      background: #16a34a;
    }

    .success-message {
      background: #dcfce7;
      border: 1px solid #22c55e;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }

    .info-box {
      background: #f0f9ff;
      border-left: 4px solid #3b82f6;
      padding: 16px;
      margin-bottom: 24px;
      border-radius: 4px;
    }

    .required {
      color: #ef4444;
    }
  </style>
</head>

<body>
  <header class="app-header">
    <div class="branding">
      <span class="logo">üçé</span>
      <h1>TogetherKGO</h1>
    </div>

    <nav class="top-actions">
      <a class="chip ghost" href="home.html">Home</a>
      <a class="chip ghost" href="index.html">Food Resources</a>
      <a class="chip ghost" href="community.html">Community Board</a>
    </nav>
  </header>

  <main class="submission-form">
    <h2>Submit Community Update</h2>
    
    <div class="info-box">
      <strong>üìù For Food Bank Staff Only</strong>
      <p>Use this form to share updates with the community about your food bank's services, special events, or important notices. All submissions will be reviewed by our admin team before appearing on the community board.</p>
    </div>

    <div class="success-message" id="successMessage">
      <strong>‚úÖ Success!</strong> Your update has been submitted and is pending approval. It will appear on the community board once reviewed by our admin team.
    </div>

    <!-- Netlify Form -->
    <form name="community-update" method="POST" data-netlify="true" netlify-honeypot="bot-field" onsubmit="handleSubmit(event)">
      <!-- Hidden fields for Netlify -->
      <input type="hidden" name="form-name" value="community-update" />
      <p style="display:none;">
        <label>Don't fill this out if you're human: <input name="bot-field" /></label>
      </p>

      <!-- Food Bank Selection -->
      <div class="form-group">
        <label for="foodBank">Your Food Bank <span class="required">*</span></label>
        <select id="foodBank" name="foodBank" required>
          <option value="">Select your food bank...</option>
          <option value="fb1">East Scarborough Storefront</option>
          <option value="fb2">Scarborough Centre for Healthy Communities</option>
          <option value="fb3">West Hill Community Support Program</option>
          <option value="fb4">Boys & Girls Club of East Scarborough</option>
        </select>
      </div>

      <!-- Contact Name -->
      <div class="form-group">
        <label for="contactName">Your Name <span class="required">*</span></label>
        <input type="text" id="contactName" name="contactName" required placeholder="Jane Doe" />
        <div class="form-hint">This is for verification purposes only and won't be displayed publicly</div>
      </div>

      <!-- Contact Email -->
      <div class="form-group">
        <label for="contactEmail">Your Email <span class="required">*</span></label>
        <input type="email" id="contactEmail" name="contactEmail" required placeholder="jane@foodbank.org" />
        <div class="form-hint">We'll use this to contact you if we have questions about your submission</div>
      </div>

      <!-- Post Type -->
      <div class="form-group">
        <label for="postType">Update Type <span class="required">*</span></label>
        <select id="postType" name="postType" required>
          <option value="">Select type...</option>
          <option value="update">General Update</option>
          <option value="event">Special Event</option>
          <option value="urgent">Urgent Notice</option>
          <option value="food_available">Food Available Today</option>
        </select>
      </div>

      <!-- Title -->
      <div class="form-group">
        <label for="title">Update Title <span class="required">*</span></label>
        <input type="text" id="title" name="title" required placeholder="Fresh Produce Available Today" maxlength="100" />
        <div class="form-hint">Keep it short and descriptive (max 100 characters)</div>
      </div>

      <!-- Message -->
      <div class="form-group">
        <label for="message">Message <span class="required">*</span></label>
        <textarea id="message" name="message" required placeholder="We have fresh vegetables and fruits available this afternoon from 2-4pm. First come, first served!"></textarea>
        <div class="form-hint">Provide details about your update</div>
      </div>

      <!-- Public Contact Info (optional) -->
      <div class="form-group">
        <label for="publicContact">Public Contact Info (Optional)</label>
        <input type="text" id="publicContact" name="publicContact" placeholder="416-XXX-XXXX or email@foodbank.org" />
        <div class="form-hint">This will be displayed publicly if provided (e.g., for event RSVPs)</div>
      </div>

      <!-- Expires Date (optional) -->
      <div class="form-group">
        <label for="expiresDate">Post Expires On (Optional)</label>
        <input type="date" id="expiresDate" name="expiresDate" />
        <div class="form-hint">If this update is time-sensitive, choose when it should stop appearing</div>
      </div>

      <!-- Submission Time (hidden) -->
      <input type="hidden" id="submissionTime" name="submissionTime" />

      <!-- Submit Button -->
      <button type="submit" class="submit-btn">Submit Update for Approval</button>
    </form>

    <div style="margin-top: 24px; padding: 16px; background: #f8f8f8; border-radius: 8px;">
      <h4 style="margin-top: 0;">What happens next?</h4>
      <ol style="padding-left: 20px; line-height: 1.8;">
        <li>Your submission is received and stored securely</li>
        <li>Our admin team reviews your update (usually within 24 hours)</li>
        <li>If approved, your post appears on the Community Board</li>
        <li>Community members can see your update on the website</li>
      </ol>
    </div>
  </main>

  <footer class="app-footer">
    <div class="footer-content">
      <p>&copy; 2024 TogetherKGO. Supporting the Kingston-Galloway-Orton Park community.</p>
    </div>
  </footer>

  <script>
    // Set submission time
    document.getElementById('submissionTime').value = new Date().toISOString();

    function handleSubmit(event) {
      event.preventDefault();
      
      const form = event.target;
      const formData = new FormData(form);

      // Submit to Netlify
      fetch("/", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: new URLSearchParams(formData).toString()
      })
      .then(() => {
        // Show success message
        document.getElementById('successMessage').style.display = 'block';
        
        // Reset form
        form.reset();
        
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        // Hide success message after 10 seconds
        setTimeout(() => {
          document.getElementById('successMessage').style.display = 'none';
        }, 10000);
      })
      .catch((error) => {
        alert('Error submitting form. Please try again.');
        console.error('Form submission error:', error);
      });
    }
  </script>
</body>
</html>
